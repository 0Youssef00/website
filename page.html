<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hollow Knight: Arena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
        
        body {
            background-color: #0f0f16;
            color: white;
            margin: 0;
            overflow: hidden;
            font-family: 'Cinzel', serif;
            touch-action: none;
            user-select: none;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle at center, #1a1a24 0%, #050508 100%);
        }

        canvas {
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            background-color: #16161d;
            display: none; /* Hidden until platform is chosen */
        }

        .ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: none; }
        
        #timer-display {
            position: absolute; top: 20px; width: 100%;
            text-align: center; font-size: 24px; color: #ccc;
            text-shadow: 0 0 5px black;
        }

        .hud { position: absolute; top: 20px; left: 20px; display: flex; flex-direction: column; gap: 10px; }
        .masks { display: flex; gap: 5px; }
        .mask {
            width: 20px; height: 24px; background: #e0e0e0;
            clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 100%, 0% 100%, 0% 20%);
            border: 2px solid #000; box-shadow: 0 0 5px rgba(255,255,255,0.5);
        }
        .mask.broken { background: #333; opacity: 0.5; }

        .soul-vessel-container {
            width: 40px; height: 40px; border: 2px solid #888;
            border-radius: 50%; position: relative; background: rgba(0,0,0,0.5);
            overflow: hidden;
        }
        .soul-liquid {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: rgba(255, 255, 255, 0.9); box-shadow: 0 0 10px white;
            transition: height 0.2s;
        }

        .controls-layer {
            position: absolute; bottom: 20px; width: 100%; height: 160px; pointer-events: none;
            display: none; justify-content: space-between; padding: 0 30px; box-sizing: border-box; align-items: center;
        }
        #joystick-area { width: 120px; height: 120px; position: relative; pointer-events: auto; }
        #joystick-base { width: 100%; height: 100%; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); border-radius: 50%; position: absolute; }
        #joystick-knob { width: 50px; height: 50px; background: rgba(255,255,255,0.5); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; }

        .actions-grid { display: grid; grid-template-columns: 55px 55px; grid-template-rows: 55px 55px; gap: 15px; pointer-events: auto; }
        .btn { width: 50px; height: 50px; background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; color: white; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(4px); }
        .btn:active { background: rgba(255,255,255,0.5); transform: scale(0.9); }

        /* Overlays */
        #platform-screen, #game-over, #victory-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 300;
        }
        
        .hints { position: absolute; top: 20px; right: 20px; font-size: 12px; opacity: 0.6; text-align: right; display: none; }

        .selection-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            width: 200px;
        }
        .selection-card:hover {
            background: rgba(255,255,255,0.1);
            border-color: white;
            transform: translateY(-5px);
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="platform-screen">
        <h1 class="text-3xl font-bold mb-8 tracking-widest">SELECT PLATFORM</h1>
        <div class="flex gap-6">
            <div class="selection-card" onclick="initPlatform('pc')">
                <div class="text-4xl mb-4">‚å®Ô∏è</div>
                <h2 class="text-xl font-bold">PC</h2>
                <p class="text-xs text-gray-400 mt-2">Keyboard Controls</p>
            </div>
            <div class="selection-card" onclick="initPlatform('mobile')">
                <div class="text-4xl mb-4">üì±</div>
                <h2 class="text-xl font-bold">MOBILE</h2>
                <p class="text-xs text-gray-400 mt-2">Touch & Joystick</p>
            </div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div class="ui-layer" id="ui-layer">
        <div id="timer-display">00:00.00</div>
        <div class="hud">
            <div class="masks" id="maskContainer"></div>
            <div class="flex items-center gap-2">
                <div class="soul-vessel-container">
                    <div class="soul-liquid" id="soulLiquid" style="height: 0%;"></div>
                </div>
            </div>
        </div>
        
        <div class="hints" id="pc-hints">WASD Move | Z Jump | X Attack | C Dash | A Focus</div>
        
        <div class="controls-layer" id="mobile-controls">
            <div id="joystick-area"><div id="joystick-base"></div><div id="joystick-knob"></div></div>
            <div class="actions-grid">
                <div class="btn" id="btn-jump">J</div>
                <div class="btn" id="btn-dash">‚Üù</div>
                <div class="btn" id="btn-attack">‚öî</div>
                <div class="btn" id="btn-focus">‚ú¶</div>
            </div>
        </div>

        <div id="game-over" style="display:none">
            <h1 class="text-red-500 text-4xl mb-4">DEFEATED</h1>
            <button onclick="location.reload()" class="px-6 py-2 border border-white">RETRY</button>
        </div>
    </div>
</div>

<script>
let platform = null;
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const keys = { left: false, right: false, up: false, down: false, jump: false, attack: false, dash: false, focus: false };

function initPlatform(type) {
    platform = type;
    document.getElementById('platform-screen').style.display = 'none';
    document.getElementById('ui-layer').style.display = 'block';
    canvas.style.display = 'block';
    
    if(type === 'mobile') {
        document.getElementById('mobile-controls').style.display = 'flex';
        initJoystick();
    } else {
        document.getElementById('pc-hints').style.display = 'block';
    }
    
    resize();
    requestAnimationFrame(gameLoop);
}

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);

// Minimalistic Player Class for Demo
const player = {
    x: 100, y: 100, vx: 0, vy: 0, 
    width: 30, height: 50, grounded: false,
    update() {
        if(keys.left) this.vx = -5;
        else if(keys.right) this.vx = 5;
        else this.vx *= 0.8;

        this.vy += 0.6; // gravity
        this.x += this.vx;
        this.y += this.vy;

        if(this.y + this.height > canvas.height - 50) {
            this.y = canvas.height - 50 - this.height;
            this.vy = 0;
            this.grounded = true;
        }
    },
    draw() {
        ctx.fillStyle = "white";
        ctx.fillRect(this.x, this.y, this.width, this.height);
    }
};

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw Ground
    ctx.fillStyle = "#222";
    ctx.fillRect(0, canvas.height - 50, canvas.width, 50);

    player.update();
    player.draw();

    requestAnimationFrame(gameLoop);
}

// Mobile Joystick Logic
function initJoystick() {
    const joyArea = document.getElementById('joystick-area');
    const joyKnob = document.getElementById('joystick-knob');
    let active = false;

    joyArea.addEventListener('touchstart', (e) => { active = true; handleJoy(e); });
    joyArea.addEventListener('touchmove', (e) => { if(active) handleJoy(e); });
    joyArea.addEventListener('touchend', () => {
        active = false;
        joyKnob.style.transform = `translate(-50%, -50%)`;
        keys.left = false; keys.right = false;
    });

    function handleJoy(e) {
        const rect = joyArea.getBoundingClientRect();
        const centerX = rect.left + rect.width/2;
        const touchX = e.touches[0].clientX;
        const dist = touchX - centerX;
        
        if(dist < -10) { keys.left = true; keys.right = false; }
        else if(dist > 10) { keys.right = true; keys.left = false; }
        
        const offset = Math.max(-30, Math.min(30, dist));
        joyKnob.style.transform = `translate(calc(-50% + ${offset}px), -50%)`;
    }

    // Buttons
    document.getElementById('btn-jump').ontouchstart = () => { if(player.grounded) player.vy = -12; };
}

// PC Controls
window.addEventListener('keydown', (e) => {
    if(e.key === 'ArrowLeft' || e.key === 'a') keys.left = true;
    if(e.key === 'ArrowRight' || e.key === 'd') keys.right = true;
    if(e.key === 'z' && player.grounded) player.vy = -12;
});
window.addEventListener('keyup', (e) => {
    if(e.key === 'ArrowLeft' || e.key === 'a') keys.left = false;
    if(e.key === 'ArrowRight' || e.key === 'd') keys.right = false;
});

</script>
</body>
</html>
